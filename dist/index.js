function j(e,f){var n=e.length,l=0;for(let t=0;t<n;t++){var i=(e[t]||0)-(f[t]||0);l+=i*i}return l}function E(e,f,n){var l=Math.abs(e-f);return n?l:l*l}function _(e,f){for(var n={},l=[],i=f<<2,t=e.length,s=e[0].length>0;l.length<f&&i-- >0;){let a=e[Math.floor(Math.random()*t)],u=s?a.join("_"):`${a}`;n[u]||(n[u]=!0,l.push(a))}if(l.length<f)throw new Error("Error initializating clusters");return l}function $(e,f,n){var l=n||(e[0].length?j:E),i=[],t=e.length,s=e[0].length>0,a=e[Math.floor(Math.random()*t)];for(s?a.join("_"):`${a}`,i.push(a),!0;i.length<f;){let u=[],p=i.length,x=0,h=[];for(let o=0;o<t;o++){let d=1/0;for(let b=0;b<p;b++){let r=l(e[o],i[b]);r<=d&&(d=r)}u[o]=d}for(let o=0;o<t;o++)x+=u[o];for(let o=0;o<t;o++)h[o]={i:o,v:e[o],pr:u[o]/x,cs:0};h.sort((o,d)=>o.pr-d.pr),h[0].cs=h[0].pr;for(let o=1;o<t;o++)h[o].cs=h[o-1].cs+h[o].pr;let M=Math.random(),v=0;for(;v<t-1&&h[v++].cs<M;);i.push(h[v-1].v)}return i}const y=1e4;function A(e,f,n){n=n||[];for(let l=0;l<e;l++)n[l]=f;return n}function q(e,f){let n=Array.isArray(e),l=this.centroids,i=l.length,t=1/0,s=0;for(let a=0;a<i;a++){let u=f?f(e,l[a]):n?j(e,l[a]):Math.abs(e-l[a]);u<=t&&(t=u,s=a)}return{idx:s,centroid:l[s]}}function z(e,f,n,l,i){var t=[],s=[],a=[],u=[],p=!1,x=l||y,h=e.length,M=e[0].length,v=M>0,o=[];if(n)n=="kmrand"?t=_(e,f):n=="kmpp"?t=$(e,f,i):t=n;else{let b={},r=0;for(;t.length<f;){let g=Math.floor(Math.random()*h);b[g]||(b[g]=!0,t[r++]=e[g])}}do{A(f,0,o);for(let r=0;r<h;r++){let g=1/0,k=0;for(let c=0;c<f;c++){var u=i?i(e[r],t[c]):v?j(e[r],t[c]):Math.abs(e[r]-t[c]);u<=g&&(g=u,k=c)}a[r]=k,o[k]++}var d=[],s=[];if(v)for(let r=0;r<f;r++)d[r]=A(M,0,d[r]),s[r]=t[r];else for(let r=0;r<f;r++)d[r]=0,s[r]=t[r];if(v){for(let r=0;r<f;r++)t[r]=[];for(let r=0;r<h;r++){let g=a[r],k=d[g],c=e[r];for(let w=0;w<M;w++)k[w]+=c[w]}p=!0;for(let r=0;r<f;r++){let g=t[r],k=d[r],c=s[r],w=o[r];for(let m=0;m<M;m++)g[m]=k[m]/w||0;if(p){for(let m=0;m<M;m++)if(c[m]!=g[m]){p=!1;break}}}}else{for(let r=0;r<h;r++){let g=a[r];d[g]+=e[r]}for(let r=0;r<f;r++)t[r]=d[r]/o[r]||0;p=!0;for(let r=0;r<f;r++)if(s[r]!=t[r]){p=!1;break}}p=p||--x<=0}while(!p);return{it:(l||y)-x,k:f,idxs:a,centroids:t,test:q}}export{z as default};
